"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.normaliseUkPhoneNumber = exports.validateMobile = void 0;
/**
 * Validates a user mobile number.
 *
 * Here is the documentation from AWS Cognito
 * on valid mobile numbers:
 *
 * ```
 * Phone numbers must follow these formatting rules:
 * A phone number must start with a plus (+) sign, followed
 * immediately by the country code. A phone number
 * can only contain the + sign and digits.
 * You must remove any other characters
 * from a phone number, such as parentheses, spaces,
 * or dashes (-) before submitting the value
 * to the service. For example, a United States-based
 * phone number must follow this format: +14325551212.
 * ```
 *
 * See: https://docs.aws.amazon.com/cognito/latest/developerguide/user-pool-settings-attributes.html
 *
 * Return true when `mobile` is null/undefined.
 * If a field needs to be defined, then failure
 * should be caused by `field.required()`
 * rather than this rule.
 *
 * @param mobile
 */
var validateMobile = function (mobile) {
    if (!mobile) {
        return true;
    }
    var validRegex = /^\+\d+$/;
    return Boolean((mobile === null || mobile === void 0 ? void 0 : mobile.match) && mobile.match(validRegex));
};
exports.validateMobile = validateMobile;
/**
 * Transforms a UK phone number.
 *
 * Acts the following transformations:
 * - Removes spaces
 * - Removes the leading parenthesis
 * - Replaces the leading 0 with +44
 *
 * @param {string} phoneNumber
 * @returns {string}
 */
var normaliseUkPhoneNumber = function (phoneNumber) {
    if (!phoneNumber || !phoneNumber.replace) {
        return '';
    }
    return phoneNumber
        .replace(/^\((\+?\d+)\)/, '$1')
        .replace(/[\s-]/g, '')
        .replace(/^0044/, '+44')
        .replace(/^0/, '+44');
};
exports.normaliseUkPhoneNumber = normaliseUkPhoneNumber;
//# sourceMappingURL=phoneNumber.js.map